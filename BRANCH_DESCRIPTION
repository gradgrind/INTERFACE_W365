This is a Go version of the code.
